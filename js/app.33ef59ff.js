(function(e){function t(t){for(var a,s,i=t[0],c=t[1],l=t[2],d=0,u=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&u.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);f&&f(t);while(u.length)u.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,s=1;s<n.length;s++){var i=n[s];0!==r[i]&&(a=!1)}a&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},s={app:0},r={app:0},o=[];function i(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"6f6ca75f","chunk-47878536":"04611e02","chunk-5306e6cb":"0d3dbc09"}[e]+".js"}function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-47878536":1,"chunk-5306e6cb":1};s[e]?t.push(s[e]):0!==s[e]&&n[e]&&t.push(s[e]=new Promise((function(t,n){for(var a="css/"+({about:"about"}[e]||e)+"."+{about:"31d6cfe0","chunk-47878536":"b21ac4e5","chunk-5306e6cb":"10edf29e"}[e]+".css",r=c.p+a,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var l=o[i],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===a||d===r))return t()}var u=document.getElementsByTagName("style");for(i=0;i<u.length;i++){l=u[i],d=l.getAttribute("data-href");if(d===a||d===r)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||r,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete s[e],f.parentNode.removeChild(f),n(o)},f.href=r;var h=document.getElementsByTagName("head")[0];h.appendChild(f)})).then((function(){s[e]=0})));var a=r[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise((function(t,n){a=r[e]=[t,n]}));t.push(a[2]=o);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(e);var u=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+a+": "+s+")",u.name="ChunkLoadError",u.type=a,u.request=s,n[1](u)}r[e]=void 0}};var f=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var f=d;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2ff8":function(e,t,n){},4678:function(e,t,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=r,e.exports=s,s.id="4678"},"56d7":function(e,t,n){"use strict";n.r(t);n("5e72");var a=n("3779"),s=(n("2187"),n("1fd5")),r=(n("d975"),n("3d8c")),o=(n("5b61"),n("4df5")),i=(n("04f3"),n("ed3b")),c=(n("e1f5"),n("5efb")),l=(n("805a"),n("0c63")),d=(n("ee33"),n("a79d")),u=(n("0723"),n("0020")),f=(n("e260"),n("e6cf"),n("cca6"),n("a79df"),n("2b0e")),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},p=[],b=(n("5c0b"),n("2877")),m={},g=Object(b["a"])(m,h,p,!1,null,null,null),v=g.exports,k=n("9483");Object(k["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n("d3b7");var j=n("8c4f"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("img",{attrs:{src:n("cf05"),alt:"FR网盘logo"}}),e._m(0),a("at-button",{attrs:{type:"primary",size:"large"},on:{click:function(t){e.modal1=!0}}},[e._v("点我进入")]),a("at-modal",{attrs:{styles:{width:"90%",maxWidth:"520px"},"mask-closable":!1,"show-close":!e.isLoggingIn},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[a("div",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("span",[e._v("登陆")])]),a("at-input",{attrs:{placeholder:"请输入用户名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"icon icon-user"})])],2),a("div",{staticStyle:{height:"1em"}}),a("at-input",{attrs:{placeholder:"请输入密码",type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}},[a("template",{slot:"prepend"},[a("i",{staticClass:"icon icon-lock"})])],2),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("at-button",{attrs:{type:"primary",disabled:e.isLoginBtnDisabled,loading:e.isLoggingIn},on:{click:e.handleLogin}},[e._v("登陆")])],1)],1)],1)},w=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h1",[e._v(" 欢迎使用FR网盘 "),n("br"),e._v(" 一个 "),n("span",{staticStyle:{"font-style":"italic"}},[e._v("永不限速")]),e._v(" 的网盘 ")])}],_=(n("ac1f"),n("5319"),n("e682")),x={name:"Welcome",components:{},data:function(){return{key:1,modal1:!1,username:"",password:"",email:"",isLoggingIn:!1}},computed:{isLoginBtnDisabled:function(){return""===this.username.replace(/\ /g,"")||""===this.password.replace(/\ /g,"")||this.isLoggingIn}},methods:{name:function(){},handleLogin:function(){var e=this;if(""===this.username.replace(/\ /g,"")||""===this.password.replace(/\ /g,"")||this.isLoggingIn)return!1;this.isLoggingIn=!0,Object(_["a"])("login","POST",{username:this.username,password:this.password}).then((function(t){var n=t.data.username,a=t.data.token;e.$cookies.set("username",n),e.$cookies.set("token",a),e.$router.push("home/shared")})).catch((function(t){var n;e.$Message.error(406===t.code?"用户名或密码错误":null!==(n=t.data)&&void 0!==n?n:"未知错误")})).then((function(){e.isLoggingIn=!1}))}}},S=x,M=(n("a74e"),Object(b["a"])(S,y,w,!1,null,"6f417995",null)),O=M.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"shared"},[0===e.shareds.length?n("at-alert",{staticClass:"banner-info",attrs:{message:"你还没有分享过文件哟",type:"info"}}):e._e()],1)},T=[],F={name:"Shared",components:{},mounted:function(){if(!this.getToken())return!1;this.getAllShared()},data:function(){return{key:1,token:"",shareds:[]}},computed:{isName:function(){return!1}},methods:{getCookies:function(e){var t;return null!==(t=this.$cookies.get(e))&&void 0!==t?t:null},getToken:function(){var e=this.getCookies("token");if(e)return this.token=e,!0;this.$Modal.error({content:"登陆失效，请重新登录！",width:window.innerWidth>=577.78?520:.8*window.innerWidth})},getAllShared:function(){var e=this;Object(_["a"])("shared","GET",{},this.token).then((function(e){console.log(e)})).catch((function(t){var n;e.$Message.error(406===t.code?"用户名或密码错误":null!==(n=t.data)&&void 0!==n?n:"未知错误")})).then((function(){}))}}},D=F,C=(n("7e05"),Object(b["a"])(D,z,T,!1,null,"1e732c41",null)),P=C.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mydisk"},[n("div",{staticClass:"breadcrumb"},[n("at-breadcrumb",[n("at-breadcrumb-item",{attrs:{href:e.parentBreadcrumb.length<=1?"":"javascript:void(0)"},nativeOn:{click:function(t){return e.goOutsideFolder(-1)}}},[e._v("Home")]),e.parentBreadcrumb&&""!==e.parentBreadcrumb?e._l(e.parentArr,(function(t,a){return n("at-breadcrumb-item",{key:a,attrs:{href:e.parentArr.length-1===a?"":"javascript:void(0)"},nativeOn:{click:function(t){return e.goOutsideFolder(a)}}},[e._v(" "+e._s(t)+" ")])})):e._e()],2)],1),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileInput",attrs:{type:"file",multiple:""},on:{change:e.handleUploadFile}}),n("a-table",{attrs:{"data-source":e.myfiles,scroll:{y:e.innerHeight},pagination:!1,rowKey:"id",size:"middle","row-selection":e.fileRowSelection}},[n("a-table-column",{key:"name",attrs:{title:"文件名","data-index":"name",ellipsis:!0},scopedSlots:e._u([{key:"default",fn:function(t,a){return["folder"===a.type?n("a-button",{attrs:{type:"link",icon:"folder",size:"small"},on:{click:function(n){return e.goInsideFolder(t)}}},[e._v(e._s(t))]):n("a-button",{attrs:{type:"link",size:"small"},on:{click:function(n){return e.goInsideFolder(t)}}},[e._v(e._s(t))])]}}])}),n("a-table-column",{key:"size",attrs:{title:"大小","data-index":"size",ellipsis:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t))])]}}])}),n("a-table-column",{key:"created_at",attrs:{title:"上传日期","data-index":"created_at",ellipsis:!0}}),n("a-table-column",{key:"action",attrs:{title:"操作",ellipsis:!0},scopedSlots:e._u([{key:"default",fn:function(t,a){return[n("span",[n("a-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleShareFiles([a])}}},[e._v("分享")]),n("a-divider",{attrs:{type:"vertical"}}),n("a-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDeleteFiles([a])}}},[e._v("删除")])],1)]}}])})],1),n("div",{staticClass:"add-button-wrapper"},[n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.showPopupAddButtons,expression:"showPopupAddButtons"}],staticClass:"btn-add-popup-wrapper"},[n("a-button",{staticClass:"btn-add btn-add-popup",attrs:{type:"primary",icon:"folder-add",shape:"circle"},on:{click:e.handleAddFolder}}),n("a-button",{staticClass:"btn-add btn-add-popup",attrs:{type:"primary",icon:"file-add",shape:"circle"},on:{click:e.chooseFileToUpload}})],1)]),n("a-button",{staticClass:"btn-add btn-add-main",class:{"popup-open":e.showPopupAddButtons},attrs:{type:"primary",icon:"plus",shape:"circle"},nativeOn:{click:function(t){return t.stopPropagation(),e.togglePopupAddButtons(t)}}})],1),n("at-modal",{attrs:{styles:{width:"90%",maxWidth:"720px"},"mask-closable":!1,"show-close":e.uploadFinish,closeOnPressEsc:e.uploadFinish},model:{value:e.uploadModal,callback:function(t){e.uploadModal=t},expression:"uploadModal"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("span",[e._v(e._s(e.uploadModalHeader))])]),n("a-table",{attrs:{"data-source":e.uploadFilesData,scroll:{y:e.uploadModalTableHeight},pagination:!1,rowKey:"iid",size:"middle"}},[n("a-table-column",{key:"name",attrs:{title:"文件名","data-index":"name",ellipsis:!0},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t))])]}}])}),n("a-table-column",{key:"size",attrs:{title:"大小","data-index":"size",ellipsis:!0,width:"82px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t))])]}}])}),n("a-table-column",{key:"progress",attrs:{title:"进度","data-index":"progress",ellipsis:!0,width:"232px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t))])]}}])})],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("at-button",{attrs:{type:"primary",disabled:!e.uploadFinish},on:{click:function(t){e.uploadModal=!1}}},[e._v("关闭")])],1)],1),n("at-modal",{attrs:{styles:{width:"90%",maxWidth:"400px"},"mask-closable":!1,"show-close":!e.requestSharing,closeOnPressEsc:!e.requestSharing},model:{value:e.shareModal,callback:function(t){e.shareModal=t},expression:"shareModal"}},[n("div",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("span",[e._v("分享文件")])]),e.sharingFinished||e.requestSharing?n("a-skeleton",{attrs:{loading:e.requestSharing,active:""}},[n("div",[""===e.shareLink?n("a-result",{attrs:{status:"error",title:"分享失败","sub-title":"可以尝试过几分钟重试"}}):n("a-result",{attrs:{status:"success",title:"分享成功","sub-title":"链接:"}},[n("at-input",{attrs:{readonly:""},model:{value:e.shareLink,callback:function(t){e.shareLink=t},expression:"shareLink"}},[n("template",{slot:"prepend"},[n("i",{staticClass:"icon icon-link"})])],2),e.showCopyButton?n("a-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.shareLink,expression:"shareLink",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopySuccess,expression:"onCopySuccess",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onCopyError,expression:"onCopyError",arg:"error"}],attrs:{type:"primary"}},[e._v("复制并关闭")]):e._e()],1)],1)]):[n("h3",[e._v("选择分享到期日期")]),n("a-calendar",{attrs:{fullscreen:!1,valueFormat:"X",disabledDate:e.setCalendarDisabledDate,validRange:[e.moment(),e.moment().add(364,"d")]},on:{select:e.onCalendarSelect}})],n("div",{attrs:{slot:"footer"},slot:"footer"},[e.sharingFinished?n("a-button",{attrs:{type:"primary"},on:{click:function(t){e.shareModal=!1}}},[e._v("关闭")]):[e.requestSharing?e._e():n("a-button",{staticStyle:{"margin-right":"10px"},on:{click:function(t){e.shareModal=!1}}},[e._v("取消")]),n("a-button",{attrs:{type:"primary",icon:"link",loading:e.requestSharing,disabled:!e.selectedShareEndDate},on:{click:e.shareFiles}},[e._v("确认分享")])]],2)],2)],1)},B=[],L=(n("99af"),n("c975"),n("a15b"),n("d81d"),n("a434"),n("b0c0"),n("1276"),n("b85c")),$=(n("96cf"),n("1da1")),A=n("3438");function H(e){return new A({getAuthorization:function(t,n){console.log("调取签名"),Object(_["a"])("auth/getKey","GET",{},e).then((function(e){var t=e.data,a=t&&t.credentials;if(!t||!a)return console.error("credentials invalid");n({TmpSecretId:a.tmpSecretId,TmpSecretKey:a.tmpSecretKey,XCosSecurityToken:a.sessionToken,StartTime:t.startTime,ExpiredTime:t.expiredTime})})).catch((function(e){console.log(e)})).then((function(){}))}})}var I=n("c1df"),N=n.n(I),W={name:"MyDisk",components:{},data:function(){return{innerHeight:0,myfiles:[],key:1,token:"",parent:"",showPopupAddButtons:!1,lastParent:"",parentBreadcrumb:"",list:[],total:0,uploadModal:!1,uploadFinish:!1,uploadModalTableHeight:0,uploadModalTableWidth:0,uploadFilesData:[],shareModal:!1,moment:N.a,requestSharing:!1,sharingFinished:!1,selectedShareEndDate:null,shareLink:"",showCopyButton:!0}},mounted:function(){this.initialize(),this.getMyFiles()},computed:{parentPaths:function(){return!1},parentArr:function(){return this.parentBreadcrumb.substr(1).split("/")},uploadModalHeader:function(){return this.uploadFinish?"上传完成":0===this.total?"正在等待上传，请勿关闭窗口或浏览器":"正在上传，共"+this.total+"个文件，请勿关闭窗口或浏览器"},fileRowSelection:function(){return{onChange:function(e,t){console.log("selectedRowKeys: ".concat(e),"selectedRows: ",t)},getCheckboxProps:function(e){return{props:{disabled:"Disabled User"===e.name,name:e.name}}}}}},methods:{initialize:function(){var e=this;if(this.innerHeight=window.innerHeight-85-38-1-46,this.uploadModalTableHeight=.5*window.innerHeight-46,this.uploadModalTableWidth=.9*window.innerWidth>=720?720:.9*window.innerWidth,window.addEventListener("resize",(function(){e.$nextTick((function(){e.innerHeight=window.innerHeight-85-38-1-46,e.uploadModalTableHeight=.5*window.innerHeight-46,e.uploadModalTableWidth=.9*window.innerWidth>=720?720:.9*window.innerWidth}))})),document.body.addEventListener("click",(function(){e.showPopupAddButtons=!1}),!1),this.parent="",this.parentBreadcrumb="",!this.getToken())return!1;this.cos_client=H(this.token),this.cos_client.on("list-update",(function(t){e.lastList=t.list,e.updateUploadModalData(t.list)}))},setCalendarDisabledDate:function(e){return!!e&&e<N()().subtract(1,"d")},onCalendarSelect:function(e){this.selectedShareEndDate=e},shareFiles:function(){var e=this;if(!this.selectedShareEndDate)return!1;this.requestSharing=!0,Object(_["a"])("shared","POST",{ids:this.fileidsToShare,expired_at:this.selectedShareEndDate},this.token).then((function(t){e.$Message.success(t.data.msg),e.shareLink="".concat("/","/shared/").concat(t.data.data)})).catch((function(t){var n;e.$Message.error(null!==(n=t.data)&&void 0!==n?n:"遇到未知错误")})).then((function(){e.sharingFinished=!0,e.requestSharing=!1}))},handleShareFiles:function(e){if(0===e.length)return!1;this.shareLink="",this.sharingFinished=!1,this.shareModal=!0,this.selectedShareEndDate=N()().format("X"),this.fileidsToShare=e.map((function(e){return e.id}))},handleDeleteFiles:function(e){var t=this;if(0===e.length)return!1;var n="确认要删除 ".concat(e[0].name," ");e.length>1?n+="等 ".concat(e.length," 个文件/文件夹吗？"):n+="吗？",this.$confirm({title:n,content:function(e,t){return e("div",{style:{color:"red"}},"文件将在回收站中保存24小时，之后删除操作将不能被撤销！")},centered:!0,cancelText:"取消",okText:"删除",okType:"danger",onOk:function(){return t.deleteFiles(e.map((function(e){return e.id})))},onCancel:function(){}})},deleteFiles:function(e){var t=this;return new Promise((function(n,a){Object(_["a"])("disk","DELETE",{ids:e},t.token).then((function(e){t.$Message.success(e.data.msg),n()})).catch((function(e){var a;t.$Message.error(null!==(a=e.data)&&void 0!==a?a:"遇到未知错误"),n()}))}))},chooseFileToUpload:function(){this.$refs.fileInput.click()},updateUploadModalData:function(e){var t=this;this.total=e.length,this.uploadFilesData=e.map((function(e,n){return{name:e.Key.replace(/\/.+\//g,""),size:t.formatSize(e.size),progress:t.formatProgress(e,n),iid:t.toDatabase[n].iid}}))},formatSize:function(e){var t,n=["B","KB","MB","GB","TB","PB"];for(t=0;t<n.length&&e>=1024;t++)e/=1024;return(Math.round(100*e)/100||0)+n[t]},formatProgress:function(e,t){var n=e.state;switch(n){case"success":return this.toDatabase[t].error?"与数据库校验出错，请在其他文件上传完成后重试":this.toDatabase[t].finished?"上传成功":"正在检查文件完整性";case"waiting":return"等待上传";case"checking":return"正在校验文件(".concat(parseInt(100*e.hashPercent),"%)");case"paused":return"已暂停, 已传".concat(this.formatSize(e.loaded));case"canceled":return"已取消";default:return"".concat(this.formatSize(e.speed),"/s, 已传").concat(this.formatSize(e.loaded)," ").concat(parseInt(100*e.percent),"%")}},updateToDatabase:function(e,t){var n=this;return new Promise((function(a,s){Object(_["a"])("disk/".concat(e),"PATCH",{absolute_location:t},n.token).then((function(e){a(e.data)})).catch((function(e){var t;n.$Message.error(null!==(t=e.data)&&void 0!==t?t:"遇到未知错误"),a(e.data)}))}))},storeToDatabase:function(e){var t=this;return new Promise((function(n,a){Object(_["a"])("disk","POST",{files:e,parent:t.parent,type:"file"},t.token).then((function(e){n(e.data)})).catch((function(e){var a;t.$Message.error(null!==(a=e.data)&&void 0!==a?a:"遇到未知错误"),n(e.data)}))}))},handleUploadFile:function(e){var t=this;return Object($["a"])(regeneratorRuntime.mark((function a(){var s,r,o,i,c,l,d,u,f,h,p,b,m,g,v,k;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=t,r={},a.next=4,window.innerHeight;case 4:a.t0=a.sent,a.t1=.5*a.t0,o=a.t1-46,r.Bucket="frnetdisk-1251693677",r["Region"]="ap-shanghai",i=t.getCookies("username"),null!==i&&void 0!==i||t.$Message.error({message:"登陆失效，请重新登录！",duration:5e3}),c=[],t.toDatabase=[],l=n("6821"),d=Object(L["a"])(e.target.files),a.prev=15,d.s();case 17:if((u=d.n()).done){a.next=29;break}if(f=u.value,f){a.next=21;break}return a.abrupt("continue",27);case 21:if(h=f.name,p=f.size,-1===h.indexOf("/")){a.next=25;break}return a.abrupt("continue",27);case 25:c.push({Bucket:r.Bucket,Region:r.Region,Key:"/"+i+t.parent+"/"+h,Body:f}),t.toDatabase.push({name:h,size:p,iid:l(h),finished:!1});case 27:a.next=17;break;case 29:a.next=34;break;case 31:a.prev=31,a.t2=a["catch"](15),d.e(a.t2);case 34:return a.prev=34,d.f(),a.finish(34);case 37:if(0!==t.toDatabase.length){a.next=39;break}return a.abrupt("return",!1);case 39:return t.uploadFinish=!1,t.uploadModal=!0,t.uploadModalTableHeight=200,t.$nextTick((function(){t.uploadModalTableHeight=o})),t.uploadFilesData=t.toDatabase.map((function(e){return{name:e.name,size:t.formatSize(e.size),progress:"等待上传",iid:e.iid}})),a.next=46,t.storeToDatabase(t.toDatabase);case 46:if(b=a.sent,b instanceof Object&&"创建成功"===b.msg){a.next=49;break}return a.abrupt("return",!1);case 49:m=b.data,g=Object(L["a"])(t.toDatabase);try{for(g.s();!(v=g.n()).done;)k=v.value,k["id"]=m[k["iid"]]}catch(j){g.e(j)}finally{g.f()}t.cos_client.uploadFiles({files:c,SliceSize:1048576,onFileFinish:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t,n,a){var r,o,i,c,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=29;break}return r=parseInt(a.Index),e.next=4,s.updateToDatabase(s.toDatabase[r].id,a.Key);case 4:o=e.sent,o instanceof Object&&"成功"===o.msg?s.toDatabase[r].finished=!0:s.toDatabase[r].error=!0,s.updateUploadModalData(s.lastList),i=!0,c=Object(L["a"])(s.toDatabase),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=18;break}if(d=l.value,d.error||d.finished){e.next=16;break}return i=!1,e.abrupt("break",18);case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:i&&(s.uploadFinish=!0,s.getMyFiles()),e.next=30;break;case 29:console.log(a.Key+" 上传"+(t?"失败":"完成"));case 30:case"end":return e.stop()}}),e,null,[[9,20,23,26]])})));function t(t,n,a){return e.apply(this,arguments)}return t}()},(function(e,t){s.updateUploadModalData(s.lastList)}));case 53:case"end":return a.stop()}}),a,null,[[15,31,34,37]])})))()},goOutsideFolder:function(e){var t=this.parentArr;return-1===e?(""!==t[0]&&(this.lastParent=this.parent,this.parent="",this.getMyFiles()),!1):e!==t.length-1&&(this.lastParent=this.parent,t.splice(e+1),this.parent="/"+t.join("/"),void this.getMyFiles())},goInsideFolder:function(e){this.lastParent=this.parent,this.parent+="/"+e,this.getMyFiles()},getCookies:function(e){var t;return null!==(t=this.$cookies.get(e))&&void 0!==t?t:null},getToken:function(){var e=this.getCookies("token");if(e)return this.token=e,!0;this.$Message.error({message:"登陆失效，请重新登录！",duration:5e3})},getMyFiles:function(){var e=this;Object(_["a"])("disk","GET",{},this.token,{path:this.parent}).then((function(t){e.parentBreadcrumb=e.parent,e.myfiles=t.data.map((function(e){return e.created_at=new Date(Date.parse(e.created_at)).toLocaleString("zh",{hour12:!1}),e.size=Math.round(100*e.size/1024)/100+"KB",e}))})).catch((function(t){e.parent=e.lastParent,e.$Message.error(t.data)})).then((function(){}))},togglePopupAddButtons:function(){this.showPopupAddButtons=!this.showPopupAddButtons},handleAddFolder:function(){var e=this;this.$Modal.prompt({title:"提示",content:"请输入新建文件夹名称：",width:window.innerWidth>=577.78?520:.9*window.innerWidth}).then((function(t){t.value&&""!==t.value.replace(/\ /g,"")&&e.createItem(t.value,"folder")})).catch((function(){}))},createItem:function(e,t){var n=this;Object(_["a"])("disk","POST",{name:e,type:t,parent:this.parent},this.token).then((function(e){n.$Message.success({message:e.data,duration:2e3}),n.getMyFiles()})).catch((function(e){n.$Message.error(e.data)})).then((function(){}))},onCopySuccess:function(e){this.$Message.success("复制成功！"),this.shareModal=!1},onCopyError:function(e){console.log(e),this.$Message.error("复制失败，请尝试手动复制"),this.showCopyButton=!1}}},q=W,R=(n("7fda"),Object(b["a"])(q,E,B,!1,null,"7226199a",null)),K=R.exports;f["default"].use(j["a"]);var U=[{path:"/",name:"Welcome",component:O},{path:"/home",name:"Home",component:function(){return n.e("chunk-47878536").then(n.bind(null,"bb51"))},children:[{path:"shared",name:"Shared",component:P},{path:"mydisk",name:"Mydisk",component:K}],redirect:"/home/shared"},{path:"/shared/:share_event_id/:t/:token",name:"GetPrivateShare",component:function(){return n.e("chunk-5306e6cb").then(n.bind(null,"8194"))}},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}},{path:"*",redirect:"/home"}],G=new j["a"]({mode:"history",base:"/",routes:U}),X=G,J=n("44e4"),Q=n.n(J),V=(n("c58f"),n("2b27")),Y=n.n(V),Z=n("4eb5"),ee=n.n(Z),te=new f["default"];Object.defineProperties(f["default"].prototype,{$bus:{get:function(){return te}}}),f["default"].use(Q.a),f["default"].use(Y.a),f["default"].config.productionTip=!1,f["default"].use(ee.a),f["default"].use(u["a"]),f["default"].use(d["a"]),f["default"].use(l["a"]),f["default"].use(c["a"]),f["default"].use(i["a"]),f["default"].use(o["b"]),f["default"].use(r["a"]),f["default"].use(s["a"]),f["default"].use(a["a"]),f["default"].prototype.$confirm=i["a"].confirm,new f["default"]({router:X,render:function(e){return e(v)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),s=n.n(a);s.a},"7e05":function(e,t,n){"use strict";var a=n("2ff8"),s=n.n(a);s.a},"7fda":function(e,t,n){"use strict";var a=n("de85"),s=n.n(a);s.a},"9c0c":function(e,t,n){},"9c95":function(e,t,n){},a74e:function(e,t,n){"use strict";var a=n("9c95"),s=n.n(a);s.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.1f162d54.png"},de85:function(e,t,n){},e682:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("b64b"),n("d3b7");var a=n("bc3a"),s=n.n(a);function r(e){return new Promise((function(t,n){var a=s.a.create({headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:1e4});a(e).then((function(e){t(e.data)})).catch((function(e){console.log("axios错误："+e),n(e.response?e.response.data:{code:400,data:e.message})}))}))}function o(e,t,n,a,s){var o={url:"https://drive.upset.fun:14122/api/"+e,method:t};return void 0!=n&&Object.keys(n).length>0&&(o["data"]=n),void 0!=a&&""!==a&&(o["headers"]={Authorization:"Bearer "+a}),void 0!=s&&Object.keys(s).length>0&&(o["params"]=s),r(o)}}});
//# sourceMappingURL=app.33ef59ff.js.map